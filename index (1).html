<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ad Tracking Demo</title>
    <link rel="stylesheet" href="styles.css">

    <!-- Google Consent Mode (before GTM) -->
    <script>
      // Default consent: denied until user accepts
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('consent', 'default', {
        ad_storage: 'denied',
        analytics_storage: 'denied',
        functionality_storage: 'denied',
        personalization_storage: 'denied',
        security_storage: 'granted'
      });
    </script>
    <!-- End Google Consent Mode -->

   <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-N8N8QH73');</script>
<!-- End Google Tag Manager -->
    
</head>
<body>
   <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N8N8QH73"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

    <!-- Cookie Consent Banner -->
    <div id="cookie-banner" style="position: fixed; bottom: 0; left: 0; right: 0; background: #333; color: #fff; padding: 20px; text-align: center; z-index: 9999;">
      <p style="margin: 0 0 10px;">We use cookies to analyze traffic and improve your experience. Accept cookies to enable tracking.</p>
      <button id="accept-cookies" style="background: #4CAF50; color: #fff; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Accept</button>
      <button id="reject-cookies" style="background: #999; color: #fff; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Reject</button>
    </div>

    <script>
      document.getElementById('accept-cookies').addEventListener('click', function() {
        gtag('consent', 'update', {
          ad_storage: 'granted',
          analytics_storage: 'granted',
          functionality_storage: 'granted',
          personalization_storage: 'granted'
        });
        document.getElementById('cookie-banner').style.display = 'none';
        window.dataLayer.push({'event': 'cookie_consent_accepted'});
      });

      document.getElementById('reject-cookies').addEventListener('click', function() {
        gtag('consent', 'update', {
          ad_storage: 'denied',
          analytics_storage: 'denied',
          functionality_storage: 'denied',
          personalization_storage: 'denied'
        });
        document.getElementById('cookie-banner').style.display = 'none';
        window.dataLayer.push({'event': 'cookie_consent_rejected'});
      });
    </script>
    <!-- End Cookie Consent Banner -->

    <div id="landing" class="section">
        <h1 class="main-title">Ad Tracking Demo Ecommerce</h1>
        <h2 class="welcome-title">Welcome to Landing Page</h2>
        <nav>
            <a href="#products">View Products Offered</a>
            <a href="#cart">View Cart Items</a>
            <a href="#newsletter">Subscribe for Updates</a>
        </nav>
    </div>

    <div id="products" class="section" style="display:none;">
        <h1>Products Offered</h1>
        <div class="item-block" data-id="001" onclick="addToCart('Oral-Zahnbürste', 5, '001', 'Oral-B', 'Blue', 1)">
            <p>Name: Oral-Zahnbürste</p>
            <p>Brand: Oral-B</p>
            <p>Color: Blue</p>
            <p>Price: €5</p>
            <p>Quantity: <span class="quantity">1</span></p>
        </div>
        <div class="item-block" data-id="002" onclick="addToCart('Electric Razor', 15, '002', 'Brand X', 'Black', 1)">
            <p>Name: Electric Razor</p>
            <p>Brand: Brand X</p>
            <p>Color: Black</p>
            <p>Price: €15</p>
            <p>Quantity: <span class="quantity">1</span></p>
        </div>
        <div class="item-block" data-id="003" onclick="addToCart('Hair Dryer', 10, '003', 'Brand Y', 'White', 1)">
            <p>Name: Hair Dryer</p>
            <p>Brand: Brand Y</p>
            <p>Color: White</p>
            <p>Price: €10</p>
            <p>Quantity: <span class="quantity">1</span></p>
        </div>
    </div>

    <div id="cart" class="section" style="display:none;">
        <h1>View Cart Items</h1>
        <div id="cart-items"></div>
        <button id="proceed-checkout" onclick="proceedToCheckout()">Proceed to Checkout</button>
    </div>

    <div id="checkout" class="section" style="display:none;">
        <h1>Checkout</h1>
        <div id="checkout-items"></div>
        <input type="text" id="firstName" placeholder="First Name"><br>
        <input type="text" id="lastName" placeholder="Last Name"><br>
        <input type="text" id="country" placeholder="Country"><br>
        <button id="purchase" onclick="purchase()">Finish Purchase</button>
    </div>

    <div id="newsletter" class="section" style="display:none;">
        <h1 class="newsletter-title">Subscribe for Updates</h1>
        <p>Get the latest promo codes and event news!</p>
        <input type="email" id="email" placeholder="Enter email"><br>
        <button id="subscribe" onclick="subscribe()">Subscribe</button>
    </div>

    <div id="thankyou" class="section" style="display:none;">
        <h1>Thank You for Shopping!</h1>
    </div>

    <script>
        let cart = [];

        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(sec => sec.style.display = 'none');
            // Show the selected one
            document.getElementById(sectionId).style.display = 'block';
        }

        function navigateTo(sectionId) {
            showSection(sectionId);
            history.pushState({ section: sectionId }, '', '#' + sectionId);
        }

        window.addEventListener('popstate', (event) => {
            if (event.state && event.state.section) {
                showSection(event.state.section);
            } else {
                showSection('landing');
            }
        });

        function addToCart(name, price, id, brand, color, quantity) {
            cart.push({ name, price, id, brand, color, quantity });
            alert(`${name} added to cart!`);
            navigateTo('cart');
            updateCartDisplay();
        }

        function updateCartDisplay() {
            const cartItems = document.getElementById('cart-items');
            cartItems.innerHTML = cart.map(item => `
                <div class="cart-item">
                    <p>${item.name} ($${item.price}) - ID: ${item.id}</p>
                    <p>Brand: ${item.brand}, Color: ${item.color}, Qty: ${item.quantity}</p>
                    <button onclick="removeFromCart('${item.id}')">Remove</button>
                    <button onclick="addQuantity('${item.id}')">Add Qty</button>
                </div>
            `).join('');
        }

        function removeFromCart(id) {
            cart = cart.filter(item => item.id !== id);
            updateCartDisplay();
            if (cart.length === 0) {
                navigateTo('landing');
            }
        }

        function addQuantity(id) {
            const item = cart.find(item => item.id === id);
            if (item) item.quantity++;
            updateCartDisplay();
        }

        function proceedToCheckout() {
            if (cart.length > 0) {
                navigateTo('checkout');
                const checkoutItems = document.getElementById('checkout-items');
                checkoutItems.innerHTML = cart.map(item => `
                    <p>${item.name} ($${item.price}) - Qty: ${item.quantity}</p>
                `).join('');
            } else {
                alert('Cart is empty!');
            }
        }

        function purchase() {
            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
            const country = document.getElementById('country').value;
            if (firstName && lastName && country) {
                window.dataLayer = window.dataLayer || [];
                window.dataLayer.push({
                    event: 'purchase',
                    value: cart.reduce((sum, item) => sum + item.price * item.quantity, 0),
                    currency: 'EUR',
                    items: cart,
                    firstName: firstName,
                    lastName: lastName,
                    country: country
                });
                alert('Purchase completed!');
                cart = [];
                navigateTo('thankyou');
            } else {
                alert('Please fill all fields!');
            }
        }

        function subscribe() {
            const email = document.getElementById('email').value;
            if (email) {
                window.dataLayer = window.dataLayer || [];
                window.dataLayer.push({
                    event: 'newsletter_subscription',
                    email: email
                });
                navigateTo('thankyou');
            }
        }

        // Smooth scrolling + navigation
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const section = this.getAttribute('href').substring(1);
                navigateTo(section);
            });
        });

        // Initialize default section
        showSection('landing');
        history.replaceState({ section: 'landing' }, '', '#landing');
    </script>
</body>
</html>

